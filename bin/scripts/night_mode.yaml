#############
# Night mode
night_mode:
  alias: Night mode
  sequence:
    - alias: Turn on window light
      service: light.turn_on
      data:
        entity_id: light.hall_light
    - alias: Turn on bedroom light
      service: light.turn_on
      data:
        entity_id: light.bedroom_light
    - service_template: >-
        {%- if is_state("sensor.tv_status", "on") -%}
        switch.turn_off
        {%- endif -%}
      data:
        entity_id: switch.tv_power
    - delay:
        seconds: 5
    - alias: Turn off sofa light
      service: switch.turn_off
      data:
        entity_id: switch.corner_light
    - alias: Set nest to night temperature 71
      service: climate.set_temperature
      data:
        entity_id: climate.living_room_butterfly
        temperature: 71
    - delay:
        minutes: 1
    - alias: Turn off window light
      service: light.turn_off
      data:
        entity_id: light.hall_light        
    - delay:
        minutes: 9
    - alias: Turn off bedroom light
      service: light.turn_off
      data:
        entity_id: light.bedroom_light
    - service: notify.rdpi
      data:
        message: Night-mode complete
